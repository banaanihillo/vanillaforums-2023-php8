"use strict";(self.webpackChunkvanillaadmin_new=self.webpackChunkvanillaadmin_new||[]).push([[923],{50923(t,e,u){u.r(e),u.d(e,{default:()=>s});var n=u(67294),r=u(77027),l=u(20058),a=u(57298),o=u(24504);function s(t){let e=(0,l.$Y)(t.match.params.layoutID);return(null==e?void 0:e.data)?n.createElement(o.l_,{to:(0,a.qC)(r.H8.url(e.data))}):n.createElement(n.Fragment,null)}},20058(t,e,u){u.d(e,{$Y:()=>N,DE:()=>m,GP:()=>w,JI:()=>E,Jr:()=>D,U2:()=>x,Wn:()=>I,gF:()=>p});var n=u(67294),r=u(52839),l=u(40533),a=u(47178),o=u(77851),s=u(33691),i=u(52303),c=u(39607),f=u(46458),d=u(23828);function v(t,e,u,n,r,l,a){try{var o=t[l](a),s=o.value}catch(i){u(i);return}o.done?e(s):Promise.resolve(s).then(n,r)}function y(t){return function(){var e=this,u=arguments;return new Promise(function(n,r){var l=t.apply(e,u);function a(t){v(l,n,r,a,o,"next",t)}function o(t){v(l,n,r,a,o,"throw",t)}a(void 0)})}}function P(){let t=(0,l.BQ)();return(0,n.useMemo)(()=>(0,d.DE)(r,t),[t])}function E(){let{fetchAllLayouts:t}=P(),e=(0,l.BK)(({layoutSettings:t})=>t.layoutsListStatus),u=(0,l.BK)(({layoutSettings:t})=>(0,l.wN)(t));return(0,n.useEffect)(()=>{e.status===a.Px.PENDING&&t()},[e,t]),{isLoading:[a.Px.PENDING,a.Px.LOADING].includes(e.status),error:e.status===a.Px.ERROR&&e.error,layoutsByViewType:u}}function N(t){let{fetchLayout:e}=P(),u=(0,l.BK)(({layoutSettings:e})=>void 0!==t?e.layoutsByID[t]:void 0);return(0,n.useEffect)(()=>{void 0===t||u||e(t)},[e,u,t]),null!=u?u:{status:a.Px.PENDING}}function p(t){var e;let{fetchLayoutJson:u}=P(),r=(0,l.BK)(({layoutSettings:u})=>null!==(e=u.layoutJsonsByLayoutID[t])&&void 0!==e?e:{status:a.Px.PENDING});return(0,n.useEffect)(()=>{r.status===a.Px.PENDING&&u(t)},[u,r,t]),r}function m(t){var e;let{layoutID:u,layoutViewType:n}=t,a=(0,l.BQ)();return e=y(function*(t){yield a(r.putLayoutViews({layoutID:u,layoutViews:t})).unwrap(),a((0,o.updateConfigsLocal)({[`customLayout.${n}`]:!0}))}),function(t){return e.apply(this,arguments)}}function D({layoutID:t,onSuccessBeforeDeletion:e}){let u=(0,l.BQ)();return y(function*(){return u(r.deleteLayout({layoutID:t,onSuccessBeforeDeletion:e})).unwrap()})}function I(t,e){let{putLayoutLegacyView:u}=P(),r=(0,s.pm)(),l=(0,f.v9)(e=>{var u;return null!==(u=e.layoutSettings.legacyStatusesByViewType[t])&&void 0!==u?u:{status:a.Px.PENDING}});(0,n.useEffect)(()=>{l.error&&r.addToast({dismissible:!0,body:n.createElement(n.Fragment,null,(0,i.t)("Error apply layout.")," ",l.error.message)})},[l.error]);let o=(0,n.useCallback)(n=>{u({layoutViewType:t,legacyViewValue:n,legacyViewValueConfig:e})},[u]),c=l.status===a.Px.LOADING;return{isSubmitLoading:c,putLegacyView:o}}function w(t){var e,u;let n=N(t),r=x(null!==(u=null==n?void 0:null===(e=n.data)||void 0===e?void 0:e.layoutViewType)&&void 0!==u?u:null);return r}function x(t){var e,u;let{fetchLayoutCatalogByViewType:r}=P(),o=(0,l.BK)(({layoutSettings:t})=>t.catalogByViewType),s=(0,l.BK)(({layoutSettings:t})=>t.catalogStatusByViewType),i=(0,n.useMemo)(()=>null!==(e=t&&o[t])&&void 0!==e?e:null,[t,o]);(0,n.useEffect)(()=>{var e,u;if(null==t)return;let n=null!==(u=null===(e=s[t])||void 0===e?void 0:e.status)&&void 0!==u?u:a.Px.PENDING;n===a.Px.PENDING&&r(t)},[r,s,t]);let f=null!==(u=s[null!=t?t:""])&&void 0!==u?u:{status:a.Px.PENDING},d=(0,c._m)();return(0,n.useEffect)(()=>{f.status===a.Px.ERROR&&d(f.error)},[f]),i}}}]);