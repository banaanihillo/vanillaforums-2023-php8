"use strict";(self.webpackChunkvanillaadmin_new=self.webpackChunkvanillaadmin_new||[]).push([[33],{53157(e,t,n){n.d(t,{M:()=>f,r:()=>y});var r=n(57298),i=n(77027),l=n(70015),a=n(67294),s=n(20058),o=n(10923),c=n(41609),u=n.n(c),d=n(14844);let p=[];function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let f="labs.layoutEditor";function y(e){let t=p,n=(0,a.useMemo)(()=>{var e,n;return t.map(t=>{var i,l;return i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){m(e,t,n[t])})}return e}({},t),l=(l={name:(0,r.t)(null!==(e=null==t?void 0:t.name)&&void 0!==e?e:""),parentID:0,sort:0,recordID:"registeredNavItem",recordType:"customLink",children:[],url:(0,r.qC)(null!==(n=null==t?void 0:t.url)&&void 0!==n?n:"")},!0,l),Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(l)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(l)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(l,e))}),i})},[t]),c={name:(0,r.t)("Branding & SEO"),parentID:0,sort:0,recordID:"brandingAndSEO",recordType:"customLink",children:[],url:(0,r.qC)(i.EU.url(void 0))},y={name:(0,r.t)("Branding & Assets"),parentID:e,sort:0,recordID:0,recordType:"panelMenu",children:[c,...n]},g=function(e,t){let n=d.q.map(e=>`layoutEditor.${e}`),a=d.q.map(e=>`customLayout.${e}`),c=(0,l.g_)([f,...n,...a]),{layoutsByViewType:p}=(0,s.JI)(),m={home:(0,r.t)("Home"),discussionList:(0,r.t)("Discussions"),categoryList:(0,r.t)("Categories")},y={name:(0,r.t)("Layouts"),parentID:t,sort:0,recordID:e,recordType:"panelMenu",children:[]};return c.data&&d.q.forEach(t=>{var n,l,a,s,d,g,v,b,h;(null===(n=c.data)||void 0===n?void 0:n[f])&&(null===(l=c.data)||void 0===l?void 0:l[`layoutEditor.${t}`])?y.children.push((a=t,{name:(0,r.t)(`${m[a]} Page`),parentID:e,sort:0,recordID:a,recordType:"panelMenu",children:[{name:(0,r.t)("Legacy Layouts"),parentID:a,sort:0,recordID:(0,o.k$)(),recordType:"appearanceNavItem",children:[],url:(0,r.qC)(i.xh.url(a)),withCheckMark:(null==c?void 0:null===(s=c.data)||void 0===s?void 0:s[`customLayout.${a}`])==!1},...u()(p)?[]:[...(g=null!==(d=p[a])&&void 0!==d?d:[],v=a,null!==(b=g.map((e,t)=>{let n=e.layoutViewType===v&&!!e.layoutViews.length&&!!e.layoutViews.find(e=>e.layoutViewType===v);return{sort:t,name:e.name,url:(0,r.qC)(i.H8.url(e)),recordType:"customLayout",parentID:v,recordID:e.layoutID,children:[],withCheckMark:n}}))&&void 0!==b?b:[]),{name:(0,r.t)("Add Custom Layout"),parentID:a,sort:0,recordID:-1,recordType:"addLayout",isLink:!0,children:[],url:(0,r.qC)(i.W9.url({layoutViewType:a}))}]]})):y.children.push((h=t,{name:(0,r.t)(`${m[h]} Page`),parentID:h,sort:0,recordID:(0,o.k$)(),recordType:"appearanceNavItem",children:[],url:(0,r.qC)(i.xh.url(h))}))}),y}(1,e);return[y,g]}},57997(e,t,n){n.d(t,{Z:()=>g,x:()=>y});var r=n(11590),i=n(53184),l=n(94982),a=n(75994),s=n(83386),o=n(97923),c=n(75864),u=n(85938),d=n(85819);function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){p(e,t,n[t])})}return e}function f(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let y=(0,c.yI)(e=>{let{zIndex:t}=null!=e?e:{},n=(0,l.J)(),o=(0,i.d)().mediaQueries(),p=(0,r.iv)({background:"#fbfcff",borderBottom:"1px solid #dddee0",position:"sticky",top:(0,i.d)().fullHeight+1,zIndex:null!=t?t:1},";label:AdminTitleBar-classes-root;"),y=(0,c.yI)(e=>(0,r.iv)(m({display:"flex",flexDirection:"column"},s.W.margin(u.L.spacing({vertical:12,left:28,right:e?(0,d.yx)(`(100vw - ${n.contentWidth+n.gutter.full}px)/2 + ${n.gutter.full}px`):28}))),o.customBreakPoint({marginRight:n.gutter.full},n.contentWidth),o.compact({marginRight:n.gutter.size,marginLeft:n.gutter.size}),";label:AdminTitleBar-classes-container;")),g=(0,r.iv)({name:"kv8qpq-AdminTitleBar-classes-titleAndActionsContainer",styles:"display:flex;flex-direction:row;align-items:center;justify-content:space-between;label:AdminTitleBar-classes-titleAndActionsContainer;"}),v=(0,r.iv)({name:"1cecw6g-AdminTitleBar-classes-titleAndDescriptionContainer",styles:";label:AdminTitleBar-classes-titleAndDescriptionContainer;"}),b=(0,r.iv)({name:"chf42w-AdminTitleBar-classes-titleWrap",styles:"font-size:20px;font-weight:bold;color:#555a62;margin-bottom:0;display:flex;align-items:center;flex-wrap:wrap;label:AdminTitleBar-classes-titleWrap;"}),h=(0,r.iv)({name:"1c73g4-AdminTitleBar-classes-title",styles:"margin-right:16px;label:AdminTitleBar-classes-title;"}),x=(0,r.iv)({name:"pov7yh-AdminTitleBar-classes-actionsWrapper",styles:"display:flex;flex-direction:row;align-items:center;label:AdminTitleBar-classes-actionsWrapper;"}),B=(0,r.iv)({name:"894mph-AdminTitleBar-classes-descriptionWrapper",styles:"display:flex;flex-direction:row;align-items:center;margin-top:8px;label:AdminTitleBar-classes-descriptionWrapper;"}),w=(0,r.iv)(f(m({},s.W.font(f(m({},(0,a.OF)().fontSizeAndWeightVars("medium","normal")),{lineHeight:24/14}))),{"&& a":{"&:hover, &:active, &:focus, &.focus-visible":{textDecoration:"none"}}}),";label:AdminTitleBar-classes-description;");return{root:p,container:y,titleWrap:b,title:h,titleAndActionsContainer:g,titleAndDescriptionContainer:v,actionsWrapper:x,descriptionWrapper:B,description:w}}),g=(0,c.yI)(()=>{let e=(0,l.J)(),t=(0,i.d)().mediaQueries(),n=(0,r.iv)(f(m({},(0,o.CA)()),{top:0,zIndex:3,boxShadow:"0 2px 4px rgba(0,0,0,0.2)",marginBottom:1,background:"#fff"}),";label:AdminTitleBar-classes-editingContainerWrapper;"),a=(0,r.cx)(y().container(!0),(0,r.iv)({name:"1fe3u4x-AdminTitleBar-classes-editingContainer",styles:"background:#fff;label:AdminTitleBar-classes-editingContainer;"}),(0,r.iv)({name:"1fi7lhi-AdminTitleBar-classes-editingContainer",styles:"margin-top:0;margin-bottom:0;label:AdminTitleBar-classes-editingContainer;"}),(0,r.iv)({name:"jd3m3c-AdminTitleBar-classes-editingContainer",styles:"height:48px;justify-content:space-between;label:AdminTitleBar-classes-editingContainer;"})),s=(0,r.iv)({name:"1p9m90n-AdminTitleBar-classes-backButton",styles:"width:auto;display:flex;align-items:center;outline-offset:4px;label:AdminTitleBar-classes-backButton;"}),c=(0,r.iv)({name:"zx50n3-AdminTitleBar-classes-saveButton",styles:"outline-offset:4px;label:AdminTitleBar-classes-saveButton;"}),u=(0,r.iv)({name:"1dxt7ka-AdminTitleBar-classes-editTitle",styles:"flex:1;display:flex;justify-content:center;flex-direction:row;align-items:center;font-size:14px;font-weight:600;label:AdminTitleBar-classes-editTitle;"}),p=(0,r.iv)({name:"l8re57-AdminTitleBar-classes-editTitleOnMobile",styles:"margin-top:20px;flex:0;label:AdminTitleBar-classes-editTitleOnMobile;"}),g=e=>(0,r.iv)({padding:"8px 4px",textAlign:"center",fontSize:14,fontWeight:600,width:e?`${e+2}ch`:"14ch",borderColor:"transparent"},";label:AdminTitleBar-classes-editableInput;"),v=(0,r.iv)({name:"6i2he2-AdminTitleBar-classes-editActions",styles:"height:100%;flex:1;justify-content:flex-end;display:flex;flex-direction:row;align-items:center;& > *{margin-left:16px;};label:AdminTitleBar-classes-editActions;"}),b=(0,r.iv)({name:"1l46vi6-AdminTitleBar-classes-wrapper",styles:"height:100%;width:100%;margin:0 auto;display:flex;flex-direction:row;align-items:stretch;label:AdminTitleBar-classes-wrapper;"}),h=(0,r.iv)({name:"u5hayu-AdminTitleBar-classes-editLeftActions",styles:"flex:1;display:flex;flex-direction:row;align-items:center;label:AdminTitleBar-classes-editLeftActions;"}),x=(0,r.iv)({marginLeft:(0,d.yx)(`(100vw - ${e.contentWidth+e.gutter.full}px)/2 + ${e.gutter.full}px`)},t.customBreakPoint({marginLeft:e.gutter.full},e.contentWidth),t.compact({marginLeft:e.gutter.size,marginRight:e.gutter.size}),";label:AdminTitleBar-classes-noLeftPanel;");return{editLeftActions:h,editingContainer:a,editingContainerWrapper:n,backButton:s,saveButton:c,editTitle:u,editTitleOnMobile:p,editableInput:g,editActions:v,wrapper:b,noLeftPanel:x}})},20058(e,t,n){n.d(t,{$Y:()=>v,DE:()=>h,GP:()=>w,JI:()=>g,Jr:()=>x,U2:()=>T,Wn:()=>B,gF:()=>b});var r=n(67294),i=n(52839),l=n(40533),a=n(47178),s=n(77851),o=n(33691),c=n(52303),u=n(39607),d=n(46458),p=n(23828);function m(e,t,n,r,i,l,a){try{var s=e[l](a),o=s.value}catch(c){n(c);return}s.done?t(o):Promise.resolve(o).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var l=e.apply(t,n);function a(e){m(l,r,i,a,s,"next",e)}function s(e){m(l,r,i,a,s,"throw",e)}a(void 0)})}}function y(){let e=(0,l.BQ)();return(0,r.useMemo)(()=>(0,p.DE)(i,e),[e])}function g(){let{fetchAllLayouts:e}=y(),t=(0,l.BK)(({layoutSettings:e})=>e.layoutsListStatus),n=(0,l.BK)(({layoutSettings:e})=>(0,l.wN)(e));return(0,r.useEffect)(()=>{t.status===a.Px.PENDING&&e()},[t,e]),{isLoading:[a.Px.PENDING,a.Px.LOADING].includes(t.status),error:t.status===a.Px.ERROR&&t.error,layoutsByViewType:n}}function v(e){let{fetchLayout:t}=y(),n=(0,l.BK)(({layoutSettings:t})=>void 0!==e?t.layoutsByID[e]:void 0);return(0,r.useEffect)(()=>{void 0===e||n||t(e)},[t,n,e]),null!=n?n:{status:a.Px.PENDING}}function b(e){var t;let{fetchLayoutJson:n}=y(),i=(0,l.BK)(({layoutSettings:n})=>null!==(t=n.layoutJsonsByLayoutID[e])&&void 0!==t?t:{status:a.Px.PENDING});return(0,r.useEffect)(()=>{i.status===a.Px.PENDING&&n(e)},[n,i,e]),i}function h(e){var t;let{layoutID:n,layoutViewType:r}=e,a=(0,l.BQ)();return t=f(function*(e){yield a(i.putLayoutViews({layoutID:n,layoutViews:e})).unwrap(),a((0,s.updateConfigsLocal)({[`customLayout.${r}`]:!0}))}),function(e){return t.apply(this,arguments)}}function x({layoutID:e,onSuccessBeforeDeletion:t}){let n=(0,l.BQ)();return f(function*(){return n(i.deleteLayout({layoutID:e,onSuccessBeforeDeletion:t})).unwrap()})}function B(e,t){let{putLayoutLegacyView:n}=y(),i=(0,o.pm)(),l=(0,d.v9)(t=>{var n;return null!==(n=t.layoutSettings.legacyStatusesByViewType[e])&&void 0!==n?n:{status:a.Px.PENDING}});(0,r.useEffect)(()=>{l.error&&i.addToast({dismissible:!0,body:r.createElement(r.Fragment,null,(0,c.t)("Error apply layout.")," ",l.error.message)})},[l.error]);let s=(0,r.useCallback)(r=>{n({layoutViewType:e,legacyViewValue:r,legacyViewValueConfig:t})},[n]),u=l.status===a.Px.LOADING;return{isSubmitLoading:u,putLegacyView:s}}function w(e){var t,n;let r=v(e),i=T(null!==(n=null==r?void 0:null===(t=r.data)||void 0===t?void 0:t.layoutViewType)&&void 0!==n?n:null);return i}function T(e){var t,n;let{fetchLayoutCatalogByViewType:i}=y(),s=(0,l.BK)(({layoutSettings:e})=>e.catalogByViewType),o=(0,l.BK)(({layoutSettings:e})=>e.catalogStatusByViewType),c=(0,r.useMemo)(()=>null!==(t=e&&s[e])&&void 0!==t?t:null,[e,s]);(0,r.useEffect)(()=>{var t,n;if(null==e)return;let r=null!==(n=null===(t=o[e])||void 0===t?void 0:t.status)&&void 0!==n?n:a.Px.PENDING;r===a.Px.PENDING&&i(e)},[i,o,e]);let d=null!==(n=o[null!=e?e:""])&&void 0!==n?n:{status:a.Px.PENDING},p=(0,u._m)();return(0,r.useEffect)(()=>{d.status===a.Px.ERROR&&p(d.error)},[d]),c}}}]);