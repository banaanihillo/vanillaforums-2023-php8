"use strict";(self.webpackChunkvanillaadmin=self.webpackChunkvanillaadmin||[]).push([[718],{23596(e,t,n){n.d(t,{_D:()=>a,io:()=>u,ub:()=>o});var r=n(67294);function l(e,t){if(null==e)return{};var n,r,l=function(e,t){if(null==e)return{};var n,r,l={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function a(e){var{children:t}=e,n=l(e,["children"]);return r.createElement("div",Object.assign({className:"toolbar flex-wrap js-toolbar-sticky"},n),t)}function o(e){var{children:t}=e,n=l(e,["children"]);return r.createElement("div",Object.assign({className:"toolbar-buttons"},n),t)}function u(e){var{children:t}=e,n=l(e,["children"]);return r.createElement("div",Object.assign({className:"pager-wrap"},n),t)}},37718(e,t,n){n.r(t),n.d(t,{RoleRequestTable:()=>C,default:()=>w});var r=n(67294),l=n(52303),a=n(22524),o=n(47178),u=n(46458),c=n(58674),s=n(39607);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=n(35894),d=n(32119),b=n(86170),f=n(43918),p=n(30731),E=n(81612),v=n(33188),O=n(70881),y=n(98769),g=n(23596),P=n(51796),D=n(44952),j=n(17676),I=n(21663);function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){N(e,t,n[t])})}return e}function S(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function w(e){return r.createElement(r.Fragment,null,r.createElement(a.R,{title:(0,l.t)("Role Applicants")}),r.createElement(k,Object.assign({},e)))}let R={type:m.es.APPLICATION,roleID:void 0,status:m.nr.PENDING,page:1,limit:30};function k(e){var t,n,a;let d=new URLSearchParams(e.location.search),[b,f]=(0,r.useState)(null!==(t=d.get("roleID"))&&void 0!==t?t:""),[p,E]=(0,r.useState)(null!==(n=d.get("status"))&&void 0!==n?n:m.nr.PENDING),[v,I]=(0,r.useState)((0,y.ah)(d.get("page"),1)),N={type:R.type,roleID:""===b?R.roleID:(0,y.ah)(b,0),status:p,offset:(v-1)*10,limit:30},w=N.status===m.nr.PENDING?"dateInserted":"-dateOfStatus",k=function(e,t=0){let n=(0,u.v9)(e=>e.roleRequests.roleRequests),{listRoleRequests:l}=(0,c.y)(),a=(0,s.xy)(e);return(0,r.useEffect)(()=>{if(n.status===o.Px.PENDING||(null==a?void 0:a.roleID)!==e.roleID||(null==a?void 0:a.status)!==e.status||(null==a?void 0:a.offset)!==e.offset)l(e);else if(n.status===o.Px.SUCCESS&&n.data&&n.data.length<=t&&n.count&&e.limit&&n.count>=e.limit){var r,u;l((r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){i(e,t,n[t])})}return e}({},e),u=(u={reloading:!0},u),Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(u)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(u,e))}),r))}},[l,n,e.roleID,e.status,e.offset]),n}(S(h({},N),{sort:w}),15),A=function(e){let t=(0,u.v9)(e=>e.roleRequests.roleRequestMetasByID),{listRoleRequestMetas:n}=(0,c.y)();return(0,r.useEffect)(()=>{t.status===o.Px.PENDING&&n(e)},[n,t,e.type]),t}({type:m.es.APPLICATION});if(!A.data)return r.createElement(j.d,{loadable:A},"...");let q=Object.values(A.data).map(e=>({value:e.roleID.toString(),name:e.role.name}));q.unshift({value:"",name:(0,l.t)("All")});let x=[{value:m.nr.PENDING,name:(0,l.t)("Pending")},{value:m.nr.APPROVED,name:(0,l.t)("Approved")},{value:m.nr.DENIED,name:(0,l.t)("Denied")}];return r.createElement(r.Fragment,null,r.createElement(P.ZP,{value:S(h({},N),{offset:void 0,page:v}),defaults:R}),r.createElement(g._D,null,r.createElement(g.ub,null,r.createElement(O.Z,{id:"statusFilter",label:(0,l.t)("Role Request Status","Status"),options:x,onChange(e){E(e),I(1)},value:p}),r.createElement(O.Z,{id:"roleFilter",label:(0,l.t)("Role"),options:q,onChange(e){f(e),I(1)},value:b})),k&&r.createElement(g.io,null,r.createElement(D.j,{page:v,hasNext:(a=k,!!a.count&&!!a.data&&(!(a.count<=30)||!(a.data.length<=10))),onClick:e=>I(e),disabled:!k.data}))),r.createElement(j.d,{loadable:k},r.createElement(C,{roleRequests:k.data,metas:A.data})))}function C({roleRequests:e,metas:t}){var n;let{HeadItem:a}=d.S;return r.createElement(d.S,{verticalAlign:!0,head:r.createElement("tr",null,r.createElement(a,null,(0,l.t)("User")),r.createElement(a,null,(0,l.t)("Role")),r.createElement(a,{size:b._.XS},(0,l.t)("Date")),r.createElement(a,null,(0,l.t)("Attributes")),r.createElement(a,{size:b._.XS},(0,l.t)("Actions"))),body:e.slice(0,10).map(e=>{var a,o,u;return r.createElement("tr",{key:e.userID},r.createElement("td",null,r.createElement("a",{href:null===(a=e.user)||void 0===a?void 0:a.url},null===(o=e.user)||void 0===o?void 0:o.name)),r.createElement("td",null,(null===(u=e.role)||void 0===u?void 0:u.name)||(0,l.t)("Unknown")),r.createElement("td",null,r.createElement(I.Z,{timestamp:e.dateInserted})),r.createElement("td",null,r.createElement(q,{attributes:e.attributes,meta:null!==(n=t[e.roleID])&&void 0!==n?n:null})),r.createElement("td",null,r.createElement(f.e,null,r.createElement(A,{roleRequest:e}))))})})}function A({roleRequest:e,onClick:t}){let{patchRoleRequest:n}=(0,c.y)(),a=(0,u.v9)(e=>e.roleRequests).roleRequestPatchingByID[e.roleRequestID],s=a&&a.status===o.Px.LOADING;if(e.status===m.nr.APPROVED)return null;let i=r=>{n({roleRequestID:e.roleRequestID,status:r}),t&&t(e.roleRequestID,r)};return r.createElement(r.Fragment,null,r.createElement(p.Z,{className:"btn-icon",buttonType:v.q.ICON,title:(0,l.t)("Approve"),disabled:s,onClick:()=>i(m.nr.APPROVED)},r.createElement(E.pv,null)),e.status===m.nr.PENDING&&r.createElement(p.Z,{className:"btn-icon",buttonType:v.q.ICON_COMPACT,title:(0,l.t)("Deny"),disabled:s,onClick:()=>i(m.nr.DENIED)},r.createElement(E.Pz,null)),e.status===m.nr.DENIED&&r.createElement(p.Z,{className:"btn-icon",buttonType:v.q.ICON_COMPACT,title:(0,l.t)("Mark Pending"),disabled:s,onClick:()=>i(m.nr.PENDING)},r.createElement(E.tu,null)))}function q({attributes:e,meta:t}){return r.createElement("dl",null,Object.entries(e).map(([e,n])=>{var l,a;let o=null===(l=t.attributesSchema)||void 0===l?void 0:l.properties[e],u=e;return o&&(u=null!==(a=o["x-label"])&&void 0!==a?a:u),u=(0,y.e_)(u),r.createElement(r.Fragment,{key:e},r.createElement("dt",null,u),r.createElement("dd",null,r.createElement(x,{value:n})))}))}function x({value:e}){let t;switch(typeof e){case"boolean":t=e?(0,l.t)("yes"):(0,l.t)("no");break;case"object":t=null===e?"null":"object";break;default:t=e.toString()}return r.createElement(r.Fragment,null,t)}},32119(e,t,n){n.d(t,{S:()=>a});var r=n(67294),l=n(86170);function a(e){return r.createElement("div",{className:"table-wrap"},r.createElement("table",{className:"table-data"+(e.verticalAlign?" table-data-content":"")},r.createElement("thead",null,e.head),r.createElement("tbody",null,e.body)))}a.HeadItem=l.V},86170(e,t,n){n.d(t,{V:()=>o,_:()=>r});var r,l,a=n(67294);function o(e){let t=e.size||r.SM;return a.createElement("th",{className:t,"data-tj-ignore":!!e.noCollapse||void 0},e.children)}(l=r||(r={})).XS="column-xs",l.SM="column-sm",l.MD="column-md",l.LG="column-lg",l.XL="column-xl"},43918(e,t,n){n.d(t,{e:()=>l});var r=n(67294);function l(e){return r.createElement("div",{className:"options"},r.createElement("div",{className:"btn-group"},e.children))}}}]);