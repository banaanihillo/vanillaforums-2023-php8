(self.webpackChunkvanillaforum=self.webpackChunkvanillaforum||[]).push([[4057],{27432(e,t,n){"use strict";n.r(t);var a,r,i=n(68293),o=n(45607),c=n(67294),u=n(17102),s=n(62425),l=n(21965),v=n(64166),d=n(14698),m=n(78290),f=n(32201),h=n(86665),p=n(77225),g=n(33188),D=n(30731),E=n(57298),y=n(41177),I=n(47178),w=n(37703),S=n(17476),b=n(75864),P=n(16893);let x=(0,b.yI)(()=>(0,P.Y)("reactions"));function T(e){let t=x();return[I.Px.LOADING,I.Px.PENDING].includes(e.status)?c.createElement(w.Z,{small:!0,minimumTime:100}):!e.data||e.status===I.Px.ERROR||e.error?c.createElement(S.ed,{apiError:e.error}):e.data&&0===e.data.length?c.createElement("span",{style:e.stacked?{lineHeight:`${t.stackedList.sizing.width}px`}:{}},(0,E.t)("No reactions yet.")):c.createElement(y.K,{keyID:"tagID",themingVariables:t,items:e.data,maximumLength:e.maximumLength,stacked:e.stacked,openModal:e.openModal})}var k=n(22021),R=n(23675),U=n(224);function M(e,t,n,a,r,i,o){try{var c=e[i](o),u=c.value}catch(s){n(s);return}c.done?t(u):Promise.resolve(u).then(a,r)}let O=(0,R.hg)("@@reactions/getUserReactions",(r=(a=function*(e){let{userID:t}=e,{data:n}=yield U.ZP.get(`/users/${t}`,{params:{expand:["reactionsReceived"]}}),a=n.reactionsReceived,r=n.name;for(let[i,o]of Object.entries(a))a[i].url=(0,E.CN)(`/profile/reactions/${encodeURIComponent(r)}?reaction=${encodeURIComponent(o.urlcode)}`,!0);return Object.values(a)},function(){var e=this,t=arguments;return new Promise(function(n,r){var i=a.apply(e,t);function o(e){M(i,n,r,o,c,"next",e)}function c(e){M(i,n,r,o,c,"throw",e)}o(void 0)})}),function(e){return r.apply(this,arguments)}),{});var C=n(46458);function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let B=(0,R.oM)({name:"reactions",initialState:{reactionsByID:{},reactionIDsByUserID:{},reactionIDsByParamHash:{}},reducers:{},extraReducers(e){e.addCase(O.pending,(e,t)=>{let n=(0,k.Q6)(t.meta.arg);e.reactionIDsByParamHash[n]={status:I.Px.PENDING}}).addCase(O.fulfilled,(e,t)=>{var n;let a=(0,k.Q6)(t.meta.arg),r=t.payload.filter(e=>e.count>0);r.forEach(t=>{e.reactionsByID[t.tagID]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){L(e,t,n[t])})}return e}({},e.reactionsByID[t.tagID],t)});let i=r.map(({tagID:e})=>e);e.reactionIDsByParamHash[a]={status:I.Px.SUCCESS,data:i},e.reactionIDsByUserID[t.meta.arg.userID]=[...new Set((null!==(n=e.reactionIDsByUserID[t.meta.arg.userID])&&void 0!==n?n:[]).concat(i))]}).addCase(O.rejected,(e,t)=>{let n=(0,k.Q6)(t.meta.arg);e.reactionIDsByParamHash[n]={status:I.Px.ERROR,error:t.error}})}});(0,R.xC)(B).dispatch;let j=()=>(0,C.I0)(),N=C.v9;function H(e,t,n){var a;let r=(0,k.Q6)(e),i=j(),o=N(({reactions:e})=>{var t,n,i;return null!==(a=(t=e,n=r,null===(i=t.reactionIDsByParamHash[n])||void 0===i?void 0:i.status))&&void 0!==a?a:I.Px.PENDING});(0,c.useEffect)(()=>{t?i(O.fulfilled(t,r.toString(),e)):[I.Px.SUCCESS,I.Px.ERROR].includes(o)||i(O(e))},[t,i,o,r]);let u=N(({reactions:t})=>{var n,a,r;return o===I.Px.SUCCESS?(n=t,a=e.userID,null===(r=n.reactionIDsByUserID[a])||void 0===r?void 0:r.map(e=>n.reactionsByID[e])):[]});return(0,c.useEffect)(()=>{u&&(null==n||n(u))},[u,r,n]),{status:o,data:u}}function Z(e){let{userID:t,isVisible:n,exitHandler:a,title:r=(0,E.t)("Reactions")}=e,i=(0,f.V)(),o=(0,h.B)(),u=H({userID:t});return c.createElement(s.Z,{isVisible:n,size:l.Z.MEDIUM,exitHandler:a},c.createElement(v.Z,{header:c.createElement(d.Z,{closeFrame:a,title:r}),body:c.createElement(m.Z,null,c.createElement("div",{className:i.contents},c.createElement(T,Object.assign({},u)))),footer:c.createElement(p.Z,{justifyRight:!0},c.createElement(D.Z,{buttonType:g.q.TEXT,onClick:a,className:o.actionButton},(0,E.t)("OK")))}))}(0,i.xw)(B.name,B.reducer),(0,o.Tk)("ReactionListModule",function(e){var t,n,a;let{limit:{maxItems:r}}=x(),{title:i=(0,E.t)("Reactions")}=e,o=null!==(a=e.maximumLength)&&void 0!==a?a:r,[s,l]=(0,c.useState)(null!==(t=e.apiData)&&void 0!==t&&!!t.length&&(null===(n=e.apiData)||void 0===n?void 0:n.length)>o),[v,d]=(0,c.useState)(!1),m=()=>d(!0),f=()=>d(!1),h=H(e.apiParams,e.apiData,e=>{l(e.length>o)}),p=c.createElement(T,Object.assign({},h,{stacked:e.stacked,maximumLength:o,openModal:s?m:void 0}));return e.homeWidget&&(p=c.createElement(u.h,{title:i,options:{viewAll:s?{onClick:m}:void 0}},p)),c.createElement(c.Fragment,null,p,s&&c.createElement(Z,{userID:e.apiParams.userID,title:i,isVisible:v,exitHandler:f}))},{overwrite:!0})},86037:function(e,t,n){var a;(a=function(e,t){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var a="Left",r="Right",i="Down",o={delta:10,preventDefaultTouchmoveEvent:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0},c={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},u="mousemove",s="mouseup";function l(e,t){if(0===t)return e;var n=Math.PI/180*t,a=e[0]*Math.cos(n)+e[1]*Math.sin(n),r=e[1]*Math.cos(n)-e[0]*Math.sin(n);return[a,r]}e.DOWN=i,e.LEFT=a,e.RIGHT=r,e.UP="Up",e.useSwipeable=function(e){var v=e.trackMouse,d=t.useRef(n({},c)),m=t.useRef(n({},o));m.current=n({},o,e);var f,h,p,g,D=t.useMemo(function(){var e,t,o,f,h,p,g,D,E;return e=function(e){return d.current=e(d.current,m.current)},t={trackMouse:v},o=function(t){t&&"touches"in t&&t.touches.length>1||e(function(e,a){a.trackMouse&&(document.addEventListener(u,f),document.addEventListener(s,g));var r,i="touches"in t?t.touches[0]:t,o=l([i.clientX,i.clientY],a.rotationAngle);return n({},e,c,{initial:[].concat(o),xy:o,start:t.timeStamp||0})})},f=function(t){e(function(e,o){if("touches"in t&&t.touches.length>1)return e;var c,u="touches"in t?t.touches[0]:t,s=l([u.clientX,u.clientY],o.rotationAngle),v=s[0],d=s[1],m=v-e.xy[0],f=d-e.xy[1],h=Math.abs(m),p=Math.abs(f),g=(t.timeStamp||0)-e.start;if(h<o.delta&&p<o.delta&&!e.swiping)return e;var D,E,y,I,w=(D=h,E=p,y=m,I=f,D>E?y>0?r:a:I>0?i:"Up"),S={absX:h,absY:p,deltaX:m,deltaY:f,dir:w,event:t,first:e.first,initial:e.initial,velocity:Math.sqrt(h*h+p*p)/(g||1),vxvy:[m/(g||1),f/(g||1)]};S.first&&o.onSwipeStart&&o.onSwipeStart(S),o.onSwiping&&o.onSwiping(S);var b=!1;return(o.onSwiping||o.onSwiped||"onSwiped"+w in o)&&(b=!0),b&&o.preventDefaultTouchmoveEvent&&o.trackTouch&&t.cancelable&&t.preventDefault(),n({},e,{first:!1,eventData:S,swiping:!0})})},h=function(t){e(function(e,a){var r;if(e.swiping&&e.eventData){r=n({},e.eventData,{event:t}),a.onSwiped&&a.onSwiped(r);var i="onSwiped"+r.dir;i in a&&a[i](r)}else a.onTap&&a.onTap({event:t});return n({},e,c,{eventData:r})})},p=function(){document.removeEventListener(u,f),document.removeEventListener(s,g)},g=function(e){p(),h(e)},D=function(e,t){var n=function(){};if(e&&e.addEventListener){var a=[["touchstart",o],["touchmove",f],["touchend",h]];a.forEach(function(n){var a=n[0],r=n[1];return e.addEventListener(a,r,{passive:t})}),n=function(){return a.forEach(function(t){var n=t[0],a=t[1];return e.removeEventListener(n,a)})}}return n},E={ref:function(t){null!==t&&e(function(e,a){if(e.el===t)return e;var r={};return e.el&&e.el!==t&&e.cleanUpTouch&&(e.cleanUpTouch(),r.cleanUpTouch=void 0),a.trackTouch&&t&&(r.cleanUpTouch=D(t,!a.preventDefaultTouchmoveEvent)),n({},e,{el:t},r)})}},t.trackMouse&&(E.onMouseDown=o),[E,D]},[v]),E=D[0],y=D[1];return d.current=(f=d.current,h=m.current,p=y,g={},!h.trackTouch&&f.cleanUpTouch?(f.cleanUpTouch(),g.cleanUpTouch=void 0):h.trackTouch&&!f.cleanUpTouch&&f.el&&(g.cleanUpTouch=p(f.el,!h.preventDefaultTouchmoveEvent)),n({},f,g)),E}})(t,n(67294))}}]);